var H=Object.defineProperty;var D=(e,t,r)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var T=(e,t,r)=>D(e,typeof t!="symbol"?t+"":t,r);const $t=(e,t)=>{const r=e.__vccOpts||e;for(const[n,s]of t)r[n]=s;return r};class ee{constructor(){T(this,"name","JSON");T(this,"extensions",["json"])}parse(t){try{const r=JSON.parse(t);if(!r.frames||!Array.isArray(r.frames))throw new Error("配置文件格式错误：缺少 frames 数组");return r}catch(r){throw new Error(`JSON 配置文件解析失败: ${r instanceof Error?r.message:"未知错误"}`)}}export(t){return JSON.stringify(t,null,2)}getMimeType(){return"application/json"}}var k={},$={};(function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r=t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",n="["+t+"]["+r+"]*",s=new RegExp("^"+n+"$"),i=function(u,o){const c=[];let f=o.exec(u);for(;f;){const l=[];l.startIndex=o.lastIndex-f[0].length;const d=f.length;for(let p=0;p<d;p++)l.push(f[p]);c.push(l),f=o.exec(u)}return c},a=function(u){const o=s.exec(u);return!(o===null||typeof o>"u")};e.isExist=function(u){return typeof u<"u"},e.isEmptyObject=function(u){return Object.keys(u).length===0},e.merge=function(u,o,c){if(o){const f=Object.keys(o),l=f.length;for(let d=0;d<l;d++)c==="strict"?u[f[d]]=[o[f[d]]]:u[f[d]]=o[f[d]]}},e.getValue=function(u){return e.isExist(u)?u:""},e.isName=a,e.getAllMatches=i,e.nameRegexp=n})($);const F=$,te={allowBooleanAttributes:!1,unpairedTags:[]};k.validate=function(e,t){t=Object.assign({},te,t);const r=[];let n=!1,s=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let i=0;i<e.length;i++)if(e[i]==="<"&&e[i+1]==="?"){if(i+=2,i=z(e,i),i.err)return i}else if(e[i]==="<"){let a=i;if(i++,e[i]==="!"){i=M(e,i);continue}else{let u=!1;e[i]==="/"&&(u=!0,i++);let o="";for(;i<e.length&&e[i]!==">"&&e[i]!==" "&&e[i]!=="	"&&e[i]!==`
`&&e[i]!=="\r";i++)o+=e[i];if(o=o.trim(),o[o.length-1]==="/"&&(o=o.substring(0,o.length-1),i--),!fe(o)){let l;return o.trim().length===0?l="Invalid space after '<'.":l="Tag '"+o+"' is an invalid name.",g("InvalidTag",l,b(e,i))}const c=se(e,i);if(c===!1)return g("InvalidAttr","Attributes for '"+o+"' have open quote.",b(e,i));let f=c.value;if(i=c.index,f[f.length-1]==="/"){const l=i-f.length;f=f.substring(0,f.length-1);const d=U(f,t);if(d===!0)n=!0;else return g(d.err.code,d.err.msg,b(e,l+d.err.line))}else if(u)if(c.tagClosed){if(f.trim().length>0)return g("InvalidTag","Closing tag '"+o+"' can't have attributes or invalid starting.",b(e,a));if(r.length===0)return g("InvalidTag","Closing tag '"+o+"' has not been opened.",b(e,a));{const l=r.pop();if(o!==l.tagName){let d=b(e,l.tagStartPos);return g("InvalidTag","Expected closing tag '"+l.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+o+"'.",b(e,a))}r.length==0&&(s=!0)}}else return g("InvalidTag","Closing tag '"+o+"' doesn't have proper closing.",b(e,i));else{const l=U(f,t);if(l!==!0)return g(l.err.code,l.err.msg,b(e,i-f.length+l.err.line));if(s===!0)return g("InvalidXml","Multiple possible root nodes found.",b(e,i));t.unpairedTags.indexOf(o)!==-1||r.push({tagName:o,tagStartPos:a}),n=!0}for(i++;i<e.length;i++)if(e[i]==="<")if(e[i+1]==="!"){i++,i=M(e,i);continue}else if(e[i+1]==="?"){if(i=z(e,++i),i.err)return i}else break;else if(e[i]==="&"){const l=ue(e,i);if(l==-1)return g("InvalidChar","char '&' is not expected.",b(e,i));i=l}else if(s===!0&&!B(e[i]))return g("InvalidXml","Extra text at the end",b(e,i));e[i]==="<"&&i--}}else{if(B(e[i]))continue;return g("InvalidChar","char '"+e[i]+"' is not expected.",b(e,i))}if(n){if(r.length==1)return g("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",b(e,r[0].tagStartPos));if(r.length>0)return g("InvalidXml","Invalid '"+JSON.stringify(r.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return g("InvalidXml","Start tag expected.",1);return!0};function B(e){return e===" "||e==="	"||e===`
`||e==="\r"}function z(e,t){const r=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){const n=e.substr(r,t-r);if(t>5&&n==="xml")return g("InvalidXml","XML declaration allowed only at the start of the document.",b(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function M(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++)if(e[t]==="<")r++;else if(e[t]===">"&&(r--,r===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}const re='"',ne="'";function se(e,t){let r="",n="",s=!1;for(;t<e.length;t++){if(e[t]===re||e[t]===ne)n===""?n=e[t]:n!==e[t]||(n="");else if(e[t]===">"&&n===""){s=!0;break}r+=e[t]}return n!==""?!1:{value:r,index:t,tagClosed:s}}const ie=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function U(e,t){const r=F.getAllMatches(e,ie),n={};for(let s=0;s<r.length;s++){if(r[s][1].length===0)return g("InvalidAttr","Attribute '"+r[s][2]+"' has no space in starting.",P(r[s]));if(r[s][3]!==void 0&&r[s][4]===void 0)return g("InvalidAttr","Attribute '"+r[s][2]+"' is without value.",P(r[s]));if(r[s][3]===void 0&&!t.allowBooleanAttributes)return g("InvalidAttr","boolean attribute '"+r[s][2]+"' is not allowed.",P(r[s]));const i=r[s][2];if(!ae(i))return g("InvalidAttr","Attribute '"+i+"' is an invalid name.",P(r[s]));if(!n.hasOwnProperty(i))n[i]=1;else return g("InvalidAttr","Attribute '"+i+"' is repeated.",P(r[s]))}return!0}function oe(e,t){let r=/\d/;for(e[t]==="x"&&(t++,r=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function ue(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,oe(e,t);let r=0;for(;t<e.length;t++,r++)if(!(e[t].match(/\w/)&&r<20)){if(e[t]===";")break;return-1}return t}function g(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function ae(e){return F.isName(e)}function fe(e){return F.isName(e)}function b(e,t){const r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function P(e){return e.startIndex+e[1].length}var V={};const G={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,r){return e}},ce=function(e){return Object.assign({},G,e)};V.buildOptions=ce;V.defaultOptions=G;class le{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,r){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:r})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}var de=le;const he=$;function ge(e,t){const r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let n=1,s=!1,i=!1,a="";for(;t<e.length;t++)if(e[t]==="<"&&!i){if(s&&be(e,t)){t+=7;let u,o;[u,o,t]=pe(e,t+1),o.indexOf("&")===-1&&(r[Ee(u)]={regx:RegExp(`&${u};`,"g"),val:o})}else if(s&&ye(e,t))t+=8;else if(s&&me(e,t))t+=8;else if(s&&we(e,t))t+=9;else if(Ne)i=!0;else throw new Error("Invalid DOCTYPE");n++,a=""}else if(e[t]===">"){if(i?e[t-1]==="-"&&e[t-2]==="-"&&(i=!1,n--):n--,n===0)break}else e[t]==="["?s=!0:a+=e[t];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:t}}function pe(e,t){let r="";for(;t<e.length&&e[t]!=="'"&&e[t]!=='"';t++)r+=e[t];if(r=r.trim(),r.indexOf(" ")!==-1)throw new Error("External entites are not supported");const n=e[t++];let s="";for(;t<e.length&&e[t]!==n;t++)s+=e[t];return[r,s,t]}function Ne(e,t){return e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-"}function be(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y"}function ye(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T"}function me(e,t){return e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T"}function we(e,t){return e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N"}function Ee(e){if(he.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}var Te=ge;const Pe=/^[-+]?0x[a-fA-F0-9]+$/,Ae=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,Ie={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function Oe(e,t={}){if(t=Object.assign({},Ie,t),!e||typeof e!="string")return e;let r=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(r))return e;if(e==="0")return 0;if(t.hex&&Pe.test(r))return Ce(r,16);if(r.search(/[eE]/)!==-1){const n=r.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(n){if(t.leadingZeros)r=(n[1]||"")+n[3];else if(!(n[2]==="0"&&n[3][0]==="."))return e;return t.eNotation?Number(r):e}else return e}else{const n=Ae.exec(r);if(n){const s=n[1],i=n[2];let a=xe(n[3]);if(!t.leadingZeros&&i.length>0&&s&&r[2]!==".")return e;if(!t.leadingZeros&&i.length>0&&!s&&r[1]!==".")return e;if(t.leadingZeros&&i===e)return 0;{const u=Number(r),o=""+u;return o.search(/[eE]/)!==-1?t.eNotation?u:e:r.indexOf(".")!==-1?o==="0"&&a===""||o===a||s&&o==="-"+a?u:e:i?a===o||s+a===o?u:e:r===o||r===s+o?u:e}}else return e}}function xe(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}function Ce(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}var $e=Oe;function Se(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(const r of e)if(typeof r=="string"&&t===r||r instanceof RegExp&&r.test(t))return!0}:()=>!1}var J=Se;const Z=$,A=de,ve=Te,Le=$e,ke=J;let Fe=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,n)=>String.fromCharCode(Number.parseInt(n,16))}},this.addExternalEntities=Ve,this.parseXml=Me,this.parseTextData=Re,this.resolveNameSpace=_e,this.buildAttributesMap=ze,this.isItStopNode=Ge,this.replaceEntitiesValue=Xe,this.readStopNodeData=Ze,this.saveTextToParentTag=je,this.addChild=Ue,this.ignoreAttributesFn=ke(this.options.ignoreAttributes)}};function Ve(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:e[n]}}}function Re(e,t,r,n,s,i,a){if(e!==void 0&&(this.options.trimValues&&!n&&(e=e.trim()),e.length>0)){a||(e=this.replaceEntitiesValue(e));const u=this.options.tagValueProcessor(t,e,r,s,i);return u==null?e:typeof u!=typeof e||u!==e?u:this.options.trimValues?v(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?v(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function _e(e){if(this.options.removeNSPrefix){const t=e.split(":"),r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=r+t[1])}return e}const Be=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function ze(e,t,r){if(this.options.ignoreAttributes!==!0&&typeof e=="string"){const n=Z.getAllMatches(e,Be),s=n.length,i={};for(let a=0;a<s;a++){const u=this.resolveNameSpace(n[a][1]);if(this.ignoreAttributesFn(u,t))continue;let o=n[a][4],c=this.options.attributeNamePrefix+u;if(u.length)if(this.options.transformAttributeName&&(c=this.options.transformAttributeName(c)),c==="__proto__"&&(c="#__proto__"),o!==void 0){this.options.trimValues&&(o=o.trim()),o=this.replaceEntitiesValue(o);const f=this.options.attributeValueProcessor(u,o,t);f==null?i[c]=o:typeof f!=typeof o||f!==o?i[c]=f:i[c]=v(o,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[c]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const a={};return a[this.options.attributesGroupName]=i,a}return i}}const Me=function(e){e=e.replace(/\r\n?/g,`
`);const t=new A("!xml");let r=t,n="",s="";for(let i=0;i<e.length;i++)if(e[i]==="<")if(e[i+1]==="/"){const u=w(e,">",i,"Closing Tag is not closed.");let o=e.substring(i+2,u).trim();if(this.options.removeNSPrefix){const l=o.indexOf(":");l!==-1&&(o=o.substr(l+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),r&&(n=this.saveTextToParentTag(n,r,s));const c=s.substring(s.lastIndexOf(".")+1);if(o&&this.options.unpairedTags.indexOf(o)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${o}>`);let f=0;c&&this.options.unpairedTags.indexOf(c)!==-1?(f=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):f=s.lastIndexOf("."),s=s.substring(0,f),r=this.tagsNodeStack.pop(),n="",i=u}else if(e[i+1]==="?"){let u=S(e,i,!1,"?>");if(!u)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,s),!(this.options.ignoreDeclaration&&u.tagName==="?xml"||this.options.ignorePiTags)){const o=new A(u.tagName);o.add(this.options.textNodeName,""),u.tagName!==u.tagExp&&u.attrExpPresent&&(o[":@"]=this.buildAttributesMap(u.tagExp,s,u.tagName)),this.addChild(r,o,s)}i=u.closeIndex+1}else if(e.substr(i+1,3)==="!--"){const u=w(e,"-->",i+4,"Comment is not closed.");if(this.options.commentPropName){const o=e.substring(i+4,u-2);n=this.saveTextToParentTag(n,r,s),r.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}i=u}else if(e.substr(i+1,2)==="!D"){const u=ve(e,i);this.docTypeEntities=u.entities,i=u.i}else if(e.substr(i+1,2)==="!["){const u=w(e,"]]>",i,"CDATA is not closed.")-2,o=e.substring(i+9,u);n=this.saveTextToParentTag(n,r,s);let c=this.parseTextData(o,r.tagname,s,!0,!1,!0,!0);c==null&&(c=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]):r.add(this.options.textNodeName,c),i=u+2}else{let u=S(e,i,this.options.removeNSPrefix),o=u.tagName;const c=u.rawTagName;let f=u.tagExp,l=u.attrExpPresent,d=u.closeIndex;this.options.transformTagName&&(o=this.options.transformTagName(o)),r&&n&&r.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,r,s,!1));const p=r;if(p&&this.options.unpairedTags.indexOf(p.tagname)!==-1&&(r=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),o!==t.tagname&&(s+=s?"."+o:o),this.isItStopNode(this.options.stopNodes,s,o)){let h="";if(f.length>0&&f.lastIndexOf("/")===f.length-1)o[o.length-1]==="/"?(o=o.substr(0,o.length-1),s=s.substr(0,s.length-1),f=o):f=f.substr(0,f.length-1),i=u.closeIndex;else if(this.options.unpairedTags.indexOf(o)!==-1)i=u.closeIndex;else{const N=this.readStopNodeData(e,c,d+1);if(!N)throw new Error(`Unexpected end of ${c}`);i=N.i,h=N.tagContent}const y=new A(o);o!==f&&l&&(y[":@"]=this.buildAttributesMap(f,s,o)),h&&(h=this.parseTextData(h,o,s,!0,l,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),y.add(this.options.textNodeName,h),this.addChild(r,y,s)}else{if(f.length>0&&f.lastIndexOf("/")===f.length-1){o[o.length-1]==="/"?(o=o.substr(0,o.length-1),s=s.substr(0,s.length-1),f=o):f=f.substr(0,f.length-1),this.options.transformTagName&&(o=this.options.transformTagName(o));const h=new A(o);o!==f&&l&&(h[":@"]=this.buildAttributesMap(f,s,o)),this.addChild(r,h,s),s=s.substr(0,s.lastIndexOf("."))}else{const h=new A(o);this.tagsNodeStack.push(r),o!==f&&l&&(h[":@"]=this.buildAttributesMap(f,s,o)),this.addChild(r,h,s),r=h}n="",i=d}}else n+=e[i];return t.child};function Ue(e,t,r){const n=this.options.updateTag(t.tagname,r,t[":@"]);n===!1||(typeof n=="string"&&(t.tagname=n),e.addChild(t))}const Xe=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];e=e.replace(r.regx,r.val)}for(let t in this.lastEntities){const r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function je(e,t,r,n){return e&&(n===void 0&&(n=t.child.length===0),e=this.parseTextData(e,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,n),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function Ge(e,t,r){const n="*."+r;for(const s in e){const i=e[s];if(n===i||t===i)return!0}return!1}function Je(e,t,r=">"){let n,s="";for(let i=t;i<e.length;i++){let a=e[i];if(n)a===n&&(n="");else if(a==='"'||a==="'")n=a;else if(a===r[0])if(r[1]){if(e[i+1]===r[1])return{data:s,index:i}}else return{data:s,index:i};else a==="	"&&(a=" ");s+=a}}function w(e,t,r,n){const s=e.indexOf(t,r);if(s===-1)throw new Error(n);return s+t.length-1}function S(e,t,r,n=">"){const s=Je(e,t+1,n);if(!s)return;let i=s.data;const a=s.index,u=i.search(/\s/);let o=i,c=!0;u!==-1&&(o=i.substring(0,u),i=i.substring(u+1).trimStart());const f=o;if(r){const l=o.indexOf(":");l!==-1&&(o=o.substr(l+1),c=o!==s.data.substr(l+1))}return{tagName:o,tagExp:i,closeIndex:a,attrExpPresent:c,rawTagName:f}}function Ze(e,t,r){const n=r;let s=1;for(;r<e.length;r++)if(e[r]==="<")if(e[r+1]==="/"){const i=w(e,">",r,`${t} is not closed`);if(e.substring(r+2,i).trim()===t&&(s--,s===0))return{tagContent:e.substring(n,r),i};r=i}else if(e[r+1]==="?")r=w(e,"?>",r+1,"StopNode is not closed.");else if(e.substr(r+1,3)==="!--")r=w(e,"-->",r+3,"StopNode is not closed.");else if(e.substr(r+1,2)==="![")r=w(e,"]]>",r,"StopNode is not closed.")-2;else{const i=S(e,r,">");i&&((i&&i.tagName)===t&&i.tagExp[i.tagExp.length-1]!=="/"&&s++,r=i.closeIndex)}}function v(e,t,r){if(t&&typeof e=="string"){const n=e.trim();return n==="true"?!0:n==="false"?!1:Le(e,r)}else return Z.isExist(e)?e:""}var Ye=Fe,Y={};function qe(e,t){return q(e,t)}function q(e,t,r){let n;const s={};for(let i=0;i<e.length;i++){const a=e[i],u=We(a);let o="";if(r===void 0?o=u:o=r+"."+u,u===t.textNodeName)n===void 0?n=a[u]:n+=""+a[u];else{if(u===void 0)continue;if(a[u]){let c=q(a[u],t,o);const f=Qe(c,t);a[":@"]?Ke(c,a[":@"],o,t):Object.keys(c).length===1&&c[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?c=c[t.textNodeName]:Object.keys(c).length===0&&(t.alwaysCreateTextNode?c[t.textNodeName]="":c=""),s[u]!==void 0&&s.hasOwnProperty(u)?(Array.isArray(s[u])||(s[u]=[s[u]]),s[u].push(c)):t.isArray(u,o,f)?s[u]=[c]:s[u]=c}}}return typeof n=="string"?n.length>0&&(s[t.textNodeName]=n):n!==void 0&&(s[t.textNodeName]=n),s}function We(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];if(n!==":@")return n}}function Ke(e,t,r,n){if(t){const s=Object.keys(t),i=s.length;for(let a=0;a<i;a++){const u=s[a];n.isArray(u,r+"."+u,!0,!0)?e[u]=[t[u]]:e[u]=t[u]}}}function Qe(e,t){const{textNodeName:r}=t,n=Object.keys(e).length;return!!(n===0||n===1&&(e[r]||typeof e[r]=="boolean"||e[r]===0))}Y.prettify=qe;const{buildOptions:He}=V,De=Ye,{prettify:et}=Y,tt=k;let rt=class{constructor(t){this.externalEntities={},this.options=He(t)}parse(t,r){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});const i=tt.validate(t,r);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const n=new De(this.options);n.addExternalEntities(this.externalEntities);const s=n.parseXml(t);return this.options.preserveOrder||s===void 0?s:et(s,this.options)}addEntity(t,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=r}};var nt=rt;const st=`
`;function it(e,t){let r="";return t.format&&t.indentBy.length>0&&(r=st),W(e,t,"",r)}function W(e,t,r,n){let s="",i=!1;for(let a=0;a<e.length;a++){const u=e[a],o=ot(u);if(o===void 0)continue;let c="";if(r.length===0?c=o:c=`${r}.${o}`,o===t.textNodeName){let h=u[o];ut(c,t)||(h=t.tagValueProcessor(o,h),h=K(h,t)),i&&(s+=n),s+=h,i=!1;continue}else if(o===t.cdataPropName){i&&(s+=n),s+=`<![CDATA[${u[o][0][t.textNodeName]}]]>`,i=!1;continue}else if(o===t.commentPropName){s+=n+`<!--${u[o][0][t.textNodeName]}-->`,i=!0;continue}else if(o[0]==="?"){const h=X(u[":@"],t),y=o==="?xml"?"":n;let N=u[o][0][t.textNodeName];N=N.length!==0?" "+N:"",s+=y+`<${o}${N}${h}?>`,i=!0;continue}let f=n;f!==""&&(f+=t.indentBy);const l=X(u[":@"],t),d=n+`<${o}${l}`,p=W(u[o],t,c,f);t.unpairedTags.indexOf(o)!==-1?t.suppressUnpairedNode?s+=d+">":s+=d+"/>":(!p||p.length===0)&&t.suppressEmptyNode?s+=d+"/>":p&&p.endsWith(">")?s+=d+`>${p}${n}</${o}>`:(s+=d+">",p&&n!==""&&(p.includes("/>")||p.includes("</"))?s+=n+t.indentBy+p+n:s+=p,s+=`</${o}>`),i=!0}return s}function ot(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const n=t[r];if(e.hasOwnProperty(n)&&n!==":@")return n}}function X(e,t){let r="";if(e&&!t.ignoreAttributes)for(let n in e){if(!e.hasOwnProperty(n))continue;let s=t.attributeValueProcessor(n,e[n]);s=K(s,t),s===!0&&t.suppressBooleanAttributes?r+=` ${n.substr(t.attributeNamePrefix.length)}`:r+=` ${n.substr(t.attributeNamePrefix.length)}="${s}"`}return r}function ut(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===e||t.stopNodes[n]==="*."+r)return!0;return!1}function K(e,t){if(e&&e.length>0&&t.processEntities)for(let r=0;r<t.entities.length;r++){const n=t.entities[r];e=e.replace(n.regex,n.val)}return e}var at=it;const ft=at,ct=J,lt={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function m(e){this.options=Object.assign({},lt,e),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=ct(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=gt),this.processTextOrObjNode=dt,this.options.format?(this.indentate=ht,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}m.prototype.build=function(e){return this.options.preserveOrder?ft(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0,[]).val)};m.prototype.j2x=function(e,t,r){let n="",s="";const i=r.join(".");for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a))if(typeof e[a]>"u")this.isAttribute(a)&&(s+="");else if(e[a]===null)this.isAttribute(a)||a===this.options.cdataPropName?s+="":a[0]==="?"?s+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)s+=this.buildTextValNode(e[a],a,"",t);else if(typeof e[a]!="object"){const u=this.isAttribute(a);if(u&&!this.ignoreAttributesFn(u,i))n+=this.buildAttrPairStr(u,""+e[a]);else if(!u)if(a===this.options.textNodeName){let o=this.options.tagValueProcessor(a,""+e[a]);s+=this.replaceEntitiesValue(o)}else s+=this.buildTextValNode(e[a],a,"",t)}else if(Array.isArray(e[a])){const u=e[a].length;let o="",c="";for(let f=0;f<u;f++){const l=e[a][f];if(!(typeof l>"u"))if(l===null)a[0]==="?"?s+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(typeof l=="object")if(this.options.oneListGroup){const d=this.j2x(l,t+1,r.concat(a));o+=d.val,this.options.attributesGroupName&&l.hasOwnProperty(this.options.attributesGroupName)&&(c+=d.attrStr)}else o+=this.processTextOrObjNode(l,a,t,r);else if(this.options.oneListGroup){let d=this.options.tagValueProcessor(a,l);d=this.replaceEntitiesValue(d),o+=d}else o+=this.buildTextValNode(l,a,"",t)}this.options.oneListGroup&&(o=this.buildObjectNode(o,a,c,t)),s+=o}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName){const u=Object.keys(e[a]),o=u.length;for(let c=0;c<o;c++)n+=this.buildAttrPairStr(u[c],""+e[a][u[c]])}else s+=this.processTextOrObjNode(e[a],a,t,r);return{attrStr:n,val:s}};m.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function dt(e,t,r,n){const s=this.j2x(e,r+1,n.concat(t));return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,s.attrStr,r):this.buildObjectNode(s.val,t,s.attrStr,r)}m.prototype.buildObjectNode=function(e,t,r,n){if(e==="")return t[0]==="?"?this.indentate(n)+"<"+t+r+"?"+this.tagEndChar:this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar;{let s="</"+t+this.tagEndChar,i="";return t[0]==="?"&&(i="?",s=""),(r||r==="")&&e.indexOf("<")===-1?this.indentate(n)+"<"+t+r+i+">"+e+s:this.options.commentPropName!==!1&&t===this.options.commentPropName&&i.length===0?this.indentate(n)+`<!--${e}-->`+this.newLine:this.indentate(n)+"<"+t+r+i+this.tagEndChar+e+this.indentate(n)+s}};m.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};m.prototype.buildTextValNode=function(e,t,r,n){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(n)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(n)+"<"+t+r+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(t,e);return s=this.replaceEntitiesValue(s),s===""?this.indentate(n)+"<"+t+r+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+r+">"+s+"</"+t+this.tagEndChar}};m.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const r=this.options.entities[t];e=e.replace(r.regex,r.val)}return e};function ht(e){return this.options.indentBy.repeat(e)}function gt(e){return e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName?e.substr(this.attrPrefixLen):!1}var pt=m;const Nt=k,bt=nt,yt=pt;var mt={XMLParser:bt,XMLValidator:Nt,XMLBuilder:yt};function wt(e){const t=e.match(/\{(-?\d+),(-?\d+)\}/);if(!t)throw new Error(`无效的尺寸格式: ${e}`);return{w:parseInt(t[1]),h:parseInt(t[2])}}function Et(e){const t=e.match(/\{(-?\d+),(-?\d+)\}/);if(!t)throw new Error(`无效的点格式: ${e}`);return{x:parseInt(t[1]),y:parseInt(t[2])}}function Tt(e){const t=e.match(/\{\{(-?\d+),(-?\d+)\},\{(\d+),(\d+)\}\}/);if(!t)throw new Error(`无效的矩形格式: ${e}`);return{x:parseInt(t[1]),y:parseInt(t[2]),w:parseInt(t[3]),h:parseInt(t[4])}}function x(e){return e?Array.isArray(e)?e:[e]:[]}function I(e){if(!e||typeof e!="object")return"";const t=Object.keys(e);return t.length>0?t[0]:""}function C(e){const t=I(e);return t?e[t]:void 0}function E(e){if(e==null)return null;if(typeof e=="string"||typeof e=="number"||typeof e=="boolean")return String(e);if(Array.isArray(e)){for(const t of e){const r=E(t);if(r!==null)return r}return null}if(typeof e=="object"){if(e["#text"]!==void 0)return String(e["#text"]);for(const t of Object.keys(e)){const r=E(e[t]);if(r!==null)return r}}return null}function Q(e,t,r){switch(t){case"dict":return L(r);case"array":return Pt(r);case"true":return!0;case"false":return!1;case"integer":{const n=E(r);return n?parseInt(n,10):0}case"real":{const n=E(r);return n?parseFloat(n):0}case"string":{const n=E(r)??"";return n?e==="frame"||e==="sourceColorRect"?Tt(n):e==="sourceSize"||e==="size"?wt(n):e==="offset"?Et(n):n:""}default:{const n=E(r);if(n!==null){if(n==="true"||n==="false")return n==="true";const s=Number(n);return!Number.isNaN(s)&&n.trim()!==""?s:n}return r}}}function Pt(e){const t=x(e),r=[];for(const n of t){if(!n||typeof n!="object")continue;const s=I(n),i=C(n);s&&r.push(Q("",s,i))}return r}function L(e){const t=x(e),r={};let n=null;for(const s of t){if(!s||typeof s!="object")continue;const i=I(s),a=C(s);i&&(i==="key"?n=E(a):n&&(r[n]=Q(n,i,a),n=null))}return r}function At(e){const t=x(e);for(const r of t){if(!r||typeof r!="object")continue;const n=I(r),s=C(r);if(!(!n||n==="?xml")){if(n==="plist"){const i=x(s);for(const a of i){if(!a||typeof a!="object")continue;if(I(a)==="dict")return L(C(a))}}else if(n==="dict")return L(s)}}throw new Error("PLIST 格式错误：未找到 dict 节点")}class It{constructor(){T(this,"name","PLIST");T(this,"extensions",["plist"])}parse(t){try{const n=new mt.XMLParser({preserveOrder:!0,ignoreDeclaration:!0,ignoreAttributes:!0,attributeNamePrefix:"",trimValues:!0,allowBooleanAttributes:!0,parseTagValue:!0}).parse(t),s=At(n),i=s.frames,a=s.metadata;if(!i||typeof i!="object")throw new Error("PLIST 格式错误：缺少 frames");if(!a||typeof a!="object")throw new Error("PLIST 格式错误：缺少 metadata");const u=a.size||{w:0,h:0},o=a.textureFileName||"sprite.png",c=[];for(const[f,l]of Object.entries(i)){if(!l||typeof l!="object")continue;const d=l.frame;if(!d)continue;const p=l.rotated===!0||l.rotated==="true"||l.rotated===1,h=d,y=l.sourceSize||{w:h.w,h:h.h},N=l.sourceColorRect||h;let R=h.w,_=h.h;p&&(R=h.h,_=h.w),c.push({id:f,name:f,x:h.x,y:h.y,width:R,height:_,rotated:p,trimmed:N.x!==0||N.y!==0||N.w!==y.w||N.h!==y.h,sourceSize:{w:y.w,h:y.h},spriteSourceSize:{x:N.x,y:N.y,w:N.w,h:N.h}})}return{image:o,format:"RGBA8888",size:{w:u.w??0,h:u.h??0},scale:1,frames:c,meta:{app:"SpriteSheetTool",version:"1.0.0",format:"RGBA8888",size:{w:u.w??0,h:u.h??0}}}}catch(r){throw new Error(`PLIST 配置文件解析失败: ${r instanceof Error?r.message:"未知错误"}`)}}export(t){let r=`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>frames</key>
	<dict>
`;for(const n of t.frames){const s=n.name,i=`{{${n.x},${n.y}},{${n.width},${n.height}}}`,a=n.spriteSourceSize?`{${n.spriteSourceSize.x},${n.spriteSourceSize.y}}`:"{0,0}",u=n.rotated?"<true/>":"<false/>",o=n.sourceSize?`{${n.sourceSize.w},${n.sourceSize.h}}`:`{${n.width},${n.height}}`,c=n.spriteSourceSize?`{{${n.spriteSourceSize.x},${n.spriteSourceSize.y}},{${n.spriteSourceSize.w},${n.spriteSourceSize.h}}}`:i;r+=`		<key>${s}</key>
		<dict>
			<key>frame</key>
			<string>${i}</string>
			<key>offset</key>
			<string>${a}</string>
			<key>rotated</key>
			${u}
			<key>sourceColorRect</key>
			<string>${c}</string>
			<key>sourceSize</key>
			<string>${o}</string>
		</dict>
`}return r+=`	</dict>
	<key>metadata</key>
	<dict>
		<key>format</key>
		<integer>2</integer>
		<key>size</key>
		<string>{${t.size.w},${t.size.h}}</string>
		<key>textureFileName</key>
		<string>${t.image}</string>
	</dict>
</dict>
</plist>`,r}getMimeType(){return"application/xml"}}class Ot{constructor(){T(this,"parsers",new Map);this.register(new ee),this.register(new It)}register(t){for(const r of t.extensions)this.parsers.set(r.toLowerCase(),t)}getParserByExtension(t){return this.parsers.get(t.toLowerCase())||null}getParserByFilename(t){const r=t.toLowerCase().split(".").pop();return r?this.getParserByExtension(r):null}autoDetectParser(t,r){const n=this.getParserByFilename(r);if(n)return n;for(const s of this.parsers.values())try{return s.parse(t),s}catch{}return null}getAllParsers(){const t=new Set;return Array.from(this.parsers.values()).filter(r=>t.has(r)?!1:(t.add(r),!0))}getAllExtensions(){return Array.from(this.parsers.keys())}}const O=new Ot;function Lt(e,t){const r=O.autoDetectParser(e,t);if(!r){const n=O.getAllExtensions().join(", ");throw new Error(`无法识别的配置文件格式。支持格式: ${n}`)}return r.parse(e)}function kt(e){const t=O.getParserByExtension("json");return t?t.export(e):JSON.stringify(e,null,2)}function Ft(e,t="sprite-config.json"){const r=O.getParserByFilename(t);if(!r){const i=O.getParserByExtension("json");if(!i)throw new Error("JSON 解析器未注册");const a=i.export(e),u=new Blob([a],{type:i.getMimeType()});j(u,t);return}const n=r.export(e),s=new Blob([n],{type:r.getMimeType()});j(s,t)}function j(e,t){const r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}function xt(e){return new Promise((t,r)=>{const n=new FileReader,s=new Image;n.onload=i=>{var u;const a=(u=i.target)==null?void 0:u.result;s.onload=()=>{t({width:s.width,height:s.height,dataUrl:a})},s.onerror=r,s.src=a},n.onerror=r,n.readAsDataURL(e)})}async function Vt(e){const{width:t,height:r,dataUrl:n}=await xt(e);return{id:`${Date.now()}-${Math.random()}`,file:e,name:e.name,width:t,height:r,size:e.size,url:URL.createObjectURL(e),dataUrl:n}}function Rt(e,t={}){const{format:r="png",quality:n=.9}=t;return new Promise((s,i)=>{e.toBlob(a=>{a?s(a):i(new Error("图片压缩失败"))},`image/${r}`,n)})}function _t(e,t){const r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}function Bt(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>t(n),n.onerror=r,n.src=e})}export{$t as _,Rt as a,_t as b,Bt as c,Ft as d,kt as e,Vt as g,Lt as p};
