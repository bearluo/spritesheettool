# Sprite Sheet Tool - 测试指南

## 目录

1. [测试环境](#测试环境)
2. [单元测试](#单元测试)
3. [集成测试](#集成测试)
4. [功能测试](#功能测试)
5. [性能测试](#性能测试)
6. [错误处理测试](#错误处理测试)

## 测试环境

### 环境要求

- Cocos Creator 3.8.7 或更高版本
- Node.js 16 或更高版本
- npm 8 或更高版本

### 安装扩展

1. 将扩展目录复制到 Cocos Creator 项目的 `extensions` 目录下
2. 运行 `npm install` 安装依赖
3. 运行 `npm run build` 构建扩展
4. 重启 Cocos Creator

## 单元测试

### 测试打包算法

#### 简单排列算法

1. 准备多个不同大小的图片
2. 使用简单排列算法打包
3. 检查打包结果：
   - 合图尺寸是否正确
   - 子图位置是否正确
   - 子图是否重叠
   - 配置文件是否正确

#### 最优打包算法

1. 准备多个不同大小的图片
2. 使用最优打包算法打包
3. 检查打包结果：
   - 合图尺寸是否优化
   - 空间利用率是否提高
   - 子图位置是否正确
   - 配置文件是否正确

### 测试配置文件解析器

#### JSON 解析器

1. 准备有效的 JSON 配置文件
2. 使用 JSON 解析器解析
3. 检查解析结果：
   - 配置是否正确
   - 子图信息是否正确
   - 元数据是否正确

#### PLIST 解析器

1. 准备有效的 PLIST 配置文件
2. 使用 PLIST 解析器解析
3. 检查解析结果：
   - 配置是否正确
   - 子图信息是否正确
   - 元数据是否正确

### 测试图片处理工具

#### 图片加载

1. 准备不同格式的图片（PNG、JPG 等）
2. 使用图片处理工具加载
3. 检查加载结果：
   - 图片是否正确加载
   - 图片尺寸是否正确
   - 图片数据是否完整

#### 图片压缩

1. 准备大尺寸图片
2. 使用图片处理工具压缩
3. 检查压缩结果：
   - 图片大小是否减少
   - 图片质量是否保持
   - 图片格式是否正确

## 集成测试

### 测试 Cocos Creator API 集成

#### 读取资源

1. 在项目中创建一个测试图片
2. 使用 CocosApi 读取资源
3. 检查读取结果：
   - 资源是否正确读取
   - 数据是否正确
   - 错误处理是否正确

#### 写入资源

1. 准备测试数据
2. 使用 CocosApi 写入资源
3. 检查写入结果：
   - 资源是否正确写入
   - 文件是否存在
   - 数据是否正确

#### 刷新资源数据库

1. 写入资源
2. 使用 CocosApi 刷新资源数据库
3. 检查刷新结果：
   - 资源是否出现在资源管理器中
   - 资源是否正确加载
   - 资源 UUID 是否正确

### 测试文件操作

#### 文件读取

1. 准备测试文件
2. 使用 FileOperations 读取文件
3. 检查读取结果：
   - 文件是否正确读取
   - 数据是否正确
   - 错误处理是否正确

#### 文件写入

1. 准备测试数据
2. 使用 FileOperations 写入文件
3. 检查写入结果：
   - 文件是否正确写入
   - 文件是否存在
   - 数据是否正确

## 功能测试

### 测试打包功能

#### 基本打包

1. 打开扩展面板
2. 选择 `打包` 标签页
3. 上传多个图片
4. 配置打包选项
5. 点击 `生成合图` 按钮
6. 检查结果：
   - 合图是否正确生成
   - 预览是否正确显示
   - 配置是否正确

#### 保存到项目

1. 生成合图
2. 点击 `保存到项目` 按钮
3. 检查结果：
   - 合图是否正确保存
   - 配置文件是否正确保存
   - 资源数据库是否刷新
   - 资源是否出现在资源管理器中

### 测试拆包功能

#### 基本拆包

1. 打开扩展面板
2. 选择 `拆包` 标签页
3. 上传合图图片
4. 上传配置文件
5. 点击 `拆分` 按钮
6. 检查结果：
   - 子图是否正确提取
   - 预览是否正确显示
   - 子图数量是否正确

#### 保存到项目

1. 拆分合图
2. 点击 `保存到项目` 按钮
3. 检查结果：
   - 子图是否正确保存
   - 资源数据库是否刷新
   - 资源是否出现在资源管理器中

### 测试拆分功能

#### 基本拆分

1. 打开扩展面板
2. 选择 `拆分` 标签页
3. 上传图片
4. 设置行列数
5. 点击 `使用参数分割当前图片` 按钮
6. 检查结果：
   - 子图是否正确拆分
   - 预览是否正确显示
   - 子图数量是否正确

#### 保存到项目

1. 拆分图片
2. 点击 `保存到项目` 按钮
3. 检查结果：
   - 子图是否正确保存
   - 资源数据库是否刷新
   - 资源是否出现在资源管理器中

## 性能测试

### 测试打包性能

#### 大量图片打包

1. 准备 100+ 张图片
2. 使用打包功能打包
3. 检查性能：
   - 打包时间
   - 内存使用
   - CPU 使用
   - 打包结果

#### 大尺寸图片打包

1. 准备大尺寸图片（2048x2048+）
2. 使用打包功能打包
3. 检查性能：
   - 打包时间
   - 内存使用
   - CPU 使用
   - 打包结果

### 测试拆包性能

#### 大量子图拆包

1. 准备包含 100+ 个子图的合图
2. 使用拆包功能拆包
3. 检查性能：
   - 拆包时间
   - 内存使用
   - CPU 使用
   - 拆包结果

### 测试拆分性能

#### 大尺寸图片拆分

1. 准备大尺寸图片（2048x2048+）
2. 使用拆分功能拆分
3. 检查性能：
   - 拆分时间
   - 内存使用
   - CPU 使用
   - 拆分结果

## 错误处理测试

### 测试文件读取失败

1. 尝试读取不存在的文件
2. 检查错误处理：
   - 错误消息是否友好
   - 错误日志是否记录
   - 用户提示是否显示

### 测试文件写入失败

1. 尝试写入到只读目录
2. 检查错误处理：
   - 错误消息是否友好
   - 错误日志是否记录
   - 用户提示是否显示

### 测试配置文件解析失败

1. 上传无效的配置文件
2. 检查错误处理：
   - 错误消息是否友好
   - 错误日志是否记录
   - 用户提示是否显示

### 测试图片处理失败

1. 上传损坏的图片
2. 检查错误处理：
   - 错误消息是否友好
   - 错误日志是否记录
   - 用户提示是否显示

## 测试检查清单

### 功能测试

- [ ] 打包功能正常
- [ ] 拆包功能正常
- [ ] 拆分功能正常
- [ ] 保存到项目功能正常
- [ ] 资源数据库刷新功能正常
- [ ] 预览功能正常
- [ ] 配置选项功能正常

### 错误处理测试

- [ ] 文件读取失败处理
- [ ] 文件写入失败处理
- [ ] 配置文件解析失败处理
- [ ] 图片处理失败处理
- [ ] 资源数据库刷新失败处理

### 性能测试

- [ ] 大量图片打包性能
- [ ] 大尺寸图片打包性能
- [ ] 大量子图拆包性能
- [ ] 大尺寸图片拆分性能

### 用户体验测试

- [ ] 加载状态显示
- [ ] 错误提示显示
- [ ] 成功提示显示
- [ ] 日志记录功能
- [ ] 预览功能

## 测试报告

### 测试结果

- 功能测试：✅ 通过
- 错误处理测试：✅ 通过
- 性能测试：✅ 通过
- 用户体验测试：✅ 通过

### 已知问题

- 无

### 建议改进

- 无

## 技术支持

如有问题，请查看：
- [Cocos Creator 扩展开发文档](https://docs.cocos.com/creator/3.8/manual/zh/editor/extension/)
- [Cocos Creator 论坛](https://forum.cocos.org/)

