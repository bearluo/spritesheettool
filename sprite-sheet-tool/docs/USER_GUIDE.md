# Sprite Sheet Tool - 用户指南

## 目录

1. [快速开始](#快速开始)
2. [功能详解](#功能详解)
3. [使用技巧](#使用技巧)
4. [常见问题](#常见问题)
5. [故障排除](#故障排除)

## 快速开始

### 安装扩展

1. 将扩展目录复制到 Cocos Creator 项目的 `extensions` 目录下
2. 重启 Cocos Creator
3. 在菜单栏中找到 `扩展` -> `Sprite Sheet Tool` -> `打开面板`

### 第一个合图

1. 打开扩展面板
2. 选择 `打包` 标签页
3. 上传图片
4. 点击 `生成合图`
5. 点击 `保存到项目`

## 功能详解

### 合图打包

合图打包功能可以将多个图片打包成一张合图，减少 Draw Call，提高渲染性能。

#### 打包算法

- **简单排列**：按照图片顺序依次排列，适合图片大小相似的情况
- **最优打包**：使用 MaxRects 算法，自动优化空间利用，适合图片大小差异较大的情况

#### 打包选项

- **最大尺寸**：合图的最大尺寸，超过此尺寸会自动分割
- **间距**：子图之间的间距，用于防止纹理采样溢出
- **填充**：子图周围的填充，用于防止纹理采样溢出
- **2 的幂次**：将合图尺寸调整为 2 的幂次，某些 GPU 要求纹理尺寸为 2 的幂次
- **允许旋转**：允许旋转子图以优化空间利用
- **正方形**：强制合图为正方形，某些 GPU 要求纹理为正方形

#### 输出文件

- **合图图片**：`assets/sprite-sheets/sprite-{timestamp}.png`
- **配置文件**：`assets/sprite-sheets/sprite-{timestamp}.json`

### 合图拆包

合图拆包功能可以从合图中提取单个子图，支持 JSON 和 PLIST 格式配置文件。

#### 支持的格式

- **JSON 格式**：标准的 JSON 格式配置文件
- **PLIST 格式**：Cocos2d-x 常用的 PLIST 格式配置文件

#### 拆包流程

1. 上传合图图片
2. 上传配置文件
3. 点击 `拆分` 按钮
4. 预览拆分结果
5. 点击 `保存到项目` 按钮

#### 输出文件

- **子图文件**：`assets/sprites/{frame.name}`

### 图片拆分

图片拆分功能可以将一张图片按行列拆分成多个子图。

#### 拆分选项

- **默认行数**：拆分的行数
- **默认列数**：拆分的列数
- **替换原图**：是否替换原图

#### 拆分流程

1. 上传图片
2. 设置行列数
3. 点击 `使用参数分割当前图片` 按钮
4. 预览拆分结果
5. 点击 `保存到项目` 按钮

#### 输出文件

- **子图文件**：`assets/split-sprites/{baseName}_{index}.png`

## 使用技巧

### 优化合图性能

1. **使用最优打包算法**：对于图片大小差异较大的情况，使用最优打包算法可以显著提高空间利用率
2. **设置合适的间距**：间距太小可能导致纹理采样溢出，间距太大会浪费空间
3. **使用 2 的幂次**：某些 GPU 要求纹理尺寸为 2 的幂次，启用此选项可以避免问题
4. **允许旋转**：允许旋转可以优化空间利用，但会增加处理时间

### 处理大图片

1. **分批处理**：对于大量图片，可以分批处理，避免内存溢出
2. **压缩图片**：在打包前压缩图片，可以减少合图大小
3. **调整最大尺寸**：根据项目需求调整最大尺寸，避免合图过大

### 调试技巧

1. **查看日志**：打开 Cocos Creator 开发者工具，查看控制台日志
2. **检查配置文件**：检查配置文件格式是否正确
3. **预览结果**：使用预览功能检查合图和拆分结果

## 常见问题

### Q: 合图打包失败？

A: 可能的原因：
1. 图片格式不支持
2. 图片大小过大
3. 内存不足
4. 打包选项设置错误

解决方案：
1. 检查图片格式（支持 PNG、JPG 等）
2. 压缩图片或减少图片数量
3. 增加内存或分批处理
4. 检查打包选项设置

### Q: 拆包失败？

A: 可能的原因：
1. 配置文件格式错误
2. 配置文件与合图不匹配
3. 配置文件编码错误

解决方案：
1. 检查配置文件格式
2. 确保配置文件与合图匹配
3. 确保配置文件编码为 UTF-8

### Q: 拆分失败？

A: 可能的原因：
1. 行列数设置错误
2. 图片尺寸不合理
3. 内存不足

解决方案：
1. 检查行列数设置（必须大于 0）
2. 确保图片尺寸合理
3. 增加内存或减少行列数

## 故障排除

### 扩展无法打开

1. 检查扩展是否正确安装
2. 检查扩展构建是否成功
3. 重启 Cocos Creator
4. 查看 Cocos Creator 日志

### 文件保存失败

1. 检查项目路径是否正确
2. 检查是否有写入权限
3. 检查目录是否存在
4. 查看错误日志

### 配置文件解析失败

1. 检查配置文件格式
2. 检查配置文件编码
3. 检查配置文件内容
4. 查看错误日志

### 图片处理失败

1. 检查图片格式
2. 检查图片大小
3. 检查图片数据
4. 查看错误日志

## 技术支持

如有问题，请查看：
- [Cocos Creator 扩展开发文档](https://docs.cocos.com/creator/3.8/manual/zh/editor/extension/)
- [Cocos Creator 论坛](https://forum.cocos.org/)

